<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Sistema de Pedidos ‚Äî DEU FOME</title>
<style>
  :root{
    --bg:#121212; --panel:#1c1c1c; --muted:#161616; --accent:#FF6600; --accent2:#e65c00; --accent3:#cc5200;
    --text:#ffffff; --line:#2a2a2a; --line2:#333;
  }
  *{ box-sizing:border-box }
  html,body{ height:100% }
  body{
    margin:0; padding:20px;
    background:var(--bg); color:var(--text);
    font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  }

  h1{
    margin:0 0 20px;
    text-align:center; color:var(--accent);
    font-weight:800; letter-spacing:.3px;
  }
  h2{
    margin:0 0 12px; color:var(--accent);
    font-weight:700;
  }
  .panel{
    background:var(--panel); border-radius:16px;
    box-shadow:0 6px 18px rgba(255,102,0,.25);
    padding:18px; margin-bottom:20px;
    border:1px solid var(--line2);
  }

  .selector{
    display:flex; flex-wrap:wrap; gap:16px;
  }
  .selector label{
    display:flex; flex-direction:column; gap:6px; min-width:220px; font-weight:600;
  }
  select, input[type="text"], textarea{
    background:var(--muted); color:#fff; border:none; border-radius:10px; padding:10px 12px; outline:1px solid #222;
  }
  textarea{ min-height:74px; resize:vertical }

  .grid{
    display:grid; gap:10px;
  }
  .grid-3{ grid-template-columns:repeat(auto-fit, minmax(220px, 1fr)); }

  button{
    padding:8px 14px; border:none; border-radius:18px; cursor:pointer;
    color:#fff; font-weight:700; letter-spacing:.2px;
    background:linear-gradient(135deg,var(--accent),var(--accent2));
    transition:transform .15s ease, filter .2s ease;
  }
  button:hover{ transform:translateY(-1px); filter:brightness(.96) }
  .btn-secondary{ background:#2a2a2a }
  .btn-danger{ background:#b02a37 }
  .btn-ghost{
    background:#242424; border:1px solid var(--line);
  }
  .btn-wide{ padding:10px 16px; border-radius:22px }

  table{ width:100%; border-collapse:collapse; margin-top:10px; font-size:15px }
  th, td{ padding:10px; text-align:left; border:1px solid var(--line2) }
  th{ background:var(--accent); color:#fff; text-align:center }
  td:nth-child(1), td:nth-child(3){ text-align:center }

  .chip{
    display:inline-flex; align-items:center; gap:8px;
    background:#242424; border:1px solid var(--line);
    padding:7px 10px; border-radius:16px; margin:4px;
    font-size:.95em;
  }
  .chip .x{
    width:18px; height:18px; border-radius:50%;
    display:grid; place-items:center; background:#333; cursor:pointer;
    font-size:12px;
  }

  .row{
    display:flex; flex-wrap:wrap; gap:10px; align-items:center; justify-content:space-between;
  }
  .muted{ opacity:.8 }
  .spacer{ height:6px }

  /* Toast */
  #toast{
    position:fixed; right:20px; top:20px; z-index:9999;
    background:#1f1f1f; color:#fff; padding:12px 14px; border-radius:10px;
    box-shadow:0 8px 20px rgba(0,0,0,.4);
    border-left:5px solid var(--accent);
    opacity:0; transform:translateY(-10px); pointer-events:none;
    transition:opacity .25s ease, transform .25s ease;
  }
  #toast.show{ opacity:1; transform:translateY(0) }

  /* Layout mais espa√ßado entre blocos de controle */
  .controls{ display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:16px }

  /* Bot√µes menores no card√°pio */
  .menu button, .proteina button, .saladas button{
    font-size:.95em; padding:7px 12px; border-radius:16px; margin:3px;
  }

  /* Impression */
  @media print{
    body{ padding:0; background:#fff; color:#000; }
    .panel, .menu, .proteina, .saladas, .selector{ display:none !important; }
  }
</style>
</head>
<body>
  <h1>üçΩ Sistema de Pedidos ‚Äî DEU FOME üçΩ</h1>

  <!-- CONTROLES GERAIS -->
  <div class="panel">
    <h2>Configura√ß√µes do pedido</h2>
    <div class="controls">
      <label>Dia do card√°pio
        <select id="dia" onchange="atualizarMenu()">
          <option value="segunda">Segunda-feira</option>
          <option value="terca">Ter√ßa-feira</option>
          <option value="quarta">Quarta-feira</option>
          <option value="quinta">Quinta-feira</option>
          <option value="sexta">Sexta-feira</option>
          <option value="sabado">S√°bado</option>
        </select>
      </label>

      <label>Tamanho da quentinha
        <select id="tamanho">
          <option value="P">P (2 prote√≠nas) ‚Äî R$ 10,00</option>
          <option value="G">G (3 prote√≠nas) ‚Äî R$ 15,00</option>
        </select>
      </label>

      <label>Entrega ou retirada
        <select id="tipoEntrega" onchange="toggleEndereco()">
          <option value="retirada">Retirada</option>
          <option value="entrega">Entrega</option>
        </select>
      </label>

      <label id="bairroWrap" style="display:none">Bairro (taxa de entrega)
        <select id="bairro">
          <option value="">‚Äî selecione ‚Äî</option>
          <!-- Grupo 1 -->
          <option value="Bras√≠lia">Bras√≠lia ‚Äî R$ 6,00</option>
          <option value="Centro">Centro ‚Äî R$ 6,00</option>
          <option value="Santo Ant√¥nio">Santo Ant√¥nio ‚Äî R$ 6,00</option>
          <!-- Grupo 2 -->
          <option value="Belo Horizonte">Belo Horizonte ‚Äî R$ 7,00</option>
          <option value="Bela Vista">Bela Vista ‚Äî R$ 7,00</option>
          <option value="Jardim Magn√≥lia">Jardim Magn√≥lia ‚Äî R$ 7,00</option>
          <option value="No√© Trajano">No√© Trajano ‚Äî R$ 8,00</option>
          <option value="Novo Horizonte">Novo Horizonte ‚Äî R$ 7,00</option>
          <!-- Grupo 3 -->
          <option value="Ana Leite">Ana Leite ‚Äî R$ 7,00</option>
          <option value="Salgadinho">Salgadinho ‚Äî R$ 7,00</option>
          <option value="S√£o Sebasti√£o">S√£o Sebasti√£o ‚Äî R$ 7,00</option>
          <option value="Sete Casas">Sete Casas ‚Äî R$ 7,00</option>
          <!-- Zona Sul -->
          <option value="Alto da Atubiba">Alto da Atubiba ‚Äî R$ 9,00</option>
          <option value="Jatob√°">Jatob√° ‚Äî R$ 7,00</option>
          <option value="Jardim Santa Cec√≠lia">Jardim Santa Cec√≠lia ‚Äî R$ 0,00</option>
          <option value="Monte Castelo">Monte Castelo ‚Äî R$ 7,00</option>
          <option value="Nova Conquista">Nova Conquista ‚Äî R$ 0,00</option>
          <!-- Zona Oeste -->
          <option value="Bivar Olinto">Bivar Olinto ‚Äî R$ 7,00</option>
          <option value="Liberdade">Liberdade ‚Äî R$ 6,00</option>
          <option value="Morada do Sol">Morada do Sol ‚Äî R$ 7,00</option>
          <option value="Maternidade">Maternidade ‚Äî R$ 6,00</option>
          <option value="Morro">Morro ‚Äî R$ 6,00</option>
        </select>
      </label>

      <label>Forma de pagamento
        <select id="pagamento" onchange="toggleTroco()">
          <option value="pix">PIX</option>
          <option value="dinheiro">Dinheiro</option>
        </select>
      </label>

      <label id="trocoWrap" style="display:none">Troco para
        <input type="text" id="trocoPara" placeholder="Ex: 50,00">
      </label>

      <label>Status
        <select id="statusPago">
          <option value="sim">Pago</option>
          <option value="nao">N√£o Pago</option>
        </select>
      </label>
    </div>
  </div>

  <!-- CARD√ÅPIO -->
  <div class="panel menu">
    <h2>Acompanhamentos</h2>
    <div id="menuAcompanhamentos" class="grid grid-3"></div>
  </div>

  <div class="panel proteina">
    <h2>Prote√≠nas</h2>
    <div id="menuProteinas" class="grid grid-3"></div>
  </div>

  <div class="panel saladas">
    <h2>Saladas</h2>
    <div id="menuSaladas" class="grid grid-3"></div>
  </div>

  <!-- MONTAGEM DA QUENTINHA ATUAL -->
  <div class="panel">
    <div class="row">
      <h2>Montagem da quentinha atual</h2>
      <div class="row" style="gap:8px">
        <button class="btn-ghost" onclick="limparQuentinhaAtual()">Limpar sele√ß√£o</button>
        <button class="btn-wide" onclick="adicionarQuentinha()">‚ûï Adicionar Quentinha</button>
      </div>
    </div>
    <div class="spacer"></div>
    <div id="chipsSelecionados" class="muted">Nenhum item selecionado ainda.</div>
    <div class="spacer"></div>
    <small class="muted">Limite autom√°tico de prote√≠nas: <strong>P = 2</strong> ‚Ä¢ <strong>G = 3</strong></small>
  </div>

  <!-- COMANDA -->
  <div class="panel">
    <h2>Comanda</h2>
    <div class="selector" style="margin-bottom:12px">
      <label>Cliente
        <input type="text" id="cliente" placeholder="Nome do cliente">
      </label>
      <label style="min-width:100%">Observa√ß√µes
        <textarea id="observacoes" placeholder="Ex: sem cebola, molho √† parte..."></textarea>
      </label>
    </div>

    <table id="pedidoTabela">
      <thead>
        <tr>
          <th style="width:110px">Tamanho</th>
          <th>Itens</th>
          <th style="width:130px">A√ß√µes</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <div class="spacer"></div>
    <button class="btn-wide" onclick="imprimirPedido()">üñ®Ô∏è Imprimir Pedido</button>
  </div>

  <!-- Toast -->
  <div id="toast">Quentinha adicionada √† comanda!</div>

<script>
/* ======= Dados do card√°pio ======= */
const cardapio = {
  segunda: {
    acompanhamentos:['Arroz branco','Arroz de Leite','Feij√£o preto','Feij√£o na farofa','Macarr√£o espaguete (molho de tomate)'],
    proteinas:['Frango ao molho','F√≠gado acebolado','Lingui√ßa mista'],
    saladas:['Pur√™ de macaxeira','Vinagrete','Batata doce']
  },
  terca: {
    acompanhamentos:['Arroz Refogado','Arroz de Leite','Feij√£o na farofa','Feij√£o no caldo','Macarr√£o espaguete (alho e √≥leo)'],
    proteinas:['Carne guisada','Lingui√ßa mista','Frango assado'],
    saladas:['Pur√™ de macaxeira','Salada','Batata doce']
  },
  quarta: {
    acompanhamentos:['Arroz branco','Arroz de Leite','Feij√£o no caldo','Feij√£o na farofa','Macarr√£o espaguete (molho de tomate)'],
    proteinas:['F√≠gado e moela','Frango assado','Lingui√ßa mista'],
    saladas:['Pur√™ de macaxeira','Vinagrete','Batata doce']
  },
  quinta: {
    acompanhamentos:['Arroz Refogado','Arroz de Leite','Feij√£o na farofa','Feij√£o no caldo','Macarr√£o espaguete (alho e √≥leo)'],
    proteinas:['Porco ao molho','Lingui√ßa mista','Frango assado'],
    saladas:['Pur√™ de macaxeira','Salada','Batata doce']
  },
  sexta: {
    acompanhamentos:['Arroz branco','Arroz de Leite','Feij√£o preto','Feij√£o na farofa','Macarr√£o espaguete (molho de tomate)'],
    proteinas:['Galinha ao molho','Frango assado','Lingui√ßa mista'],
    saladas:['Pur√™ de macaxeira','Vinagrete','Batata doce']
  },
  sabado: {
    acompanhamentos:['Arrubac√£o','Arroz refogado','Feij√£o no caldo','Feij√£o na Farofa','Macarr√£o espaguete (alho e √≥leo)'],
    proteinas:['Carne de sol (na nata)','Lingui√ßa mista','Frango assado'],
    saladas:['Batata doce','Vinagrete']
  }
};

const taxasEntrega = {
  "Bras√≠lia":6,"Centro":6,"Santo Ant√¥nio":6,
  "Belo Horizonte":7,"Bela Vista":7,"Jardim Magn√≥lia":7,"No√© Trajano":8,"Novo Horizonte":7,
  "Ana Leite":7,"Salgadinho":7,"S√£o Sebasti√£o":7,"Sete Casas":7,
  "Alto da Atubiba":9,"Jatob√°":7,"Jardim Santa Cec√≠lia":0,"Monte Castelo":7,"Nova Conquista":0,
  "Bivar Olinto":7,"Liberdade":6,"Morada do Sol":7,"Maternidade":6,"Morro":6
};

const PRECO_P = 10;
const PRECO_G = 15;

/* ======= Estado ======= */
let quentinhaAtual = [];   // itens selecionados da quentinha em montagem
let pedido = [];           // [{ tamanho:'P'|'G', itens:[...] }]

/* ======= Utils ======= */
const fmt = (n) => (n ?? 0).toLocaleString('pt-BR',{style:'currency',currency:'BRL'});

function isProteina(item){
  return Object.values(cardapio).some(dia => dia.proteinas.includes(item));
}

function toast(msg){
  const el = document.getElementById('toast');
  el.textContent = msg || 'Feito!';
  el.classList.add('show');
  setTimeout(()=>el.classList.remove('show'), 1600);
}

/* ======= UI helpers ======= */
function toggleEndereco(){
  const entrega = document.getElementById('tipoEntrega').value === 'entrega';
  document.getElementById('bairroWrap').style.display = entrega ? 'block' : 'none';
}
function toggleTroco(){
  const dinheiro = document.getElementById('pagamento').value === 'dinheiro';
  document.getElementById('trocoWrap').style.display = dinheiro ? 'block' : 'none';
}

/* ======= Render do card√°pio ======= */
function atualizarMenu(){
  const dia = document.getElementById('dia').value;
  const a = document.getElementById('menuAcompanhamentos');
  const p = document.getElementById('menuProteinas');
  const s = document.getElementById('menuSaladas');
  a.innerHTML = p.innerHTML = s.innerHTML = '';

  cardapio[dia].acompanhamentos.forEach(i=>{
    a.innerHTML += `<button onclick="addItem('${i}','outro')">${i}</button>`;
  });
  cardapio[dia].proteinas.forEach(i=>{
    p.innerHTML += `<button onclick="addItem('${i}','proteina')">${i}</button>`;
  });
  cardapio[dia].saladas.forEach(i=>{
    s.innerHTML += `<button onclick="addItem('${i}','outro')">${i}</button>`;
  });

  // ao trocar o dia, n√£o limpamos o pedido, apenas a sele√ß√£o atual (para evitar mistura indevida)
  quentinhaAtual = [];
  renderSelecionados();
}

/* ======= Sele√ß√£o de itens ======= */
function renderSelecionados(){
  const wrap = document.getElementById('chipsSelecionados');
  if(quentinhaAtual.length === 0){
    wrap.innerHTML = `<span class="muted">Nenhum item selecionado ainda.</span>`;
    return;
  }
  wrap.innerHTML = quentinhaAtual.map((i,idx)=>`
    <span class="chip">${i}<span class="x" title="remover" onclick="removerItemAtual(${idx})">√ó</span></span>
  `).join('');
}

function removerItemAtual(idx){
  quentinhaAtual.splice(idx,1);
  renderSelecionados();
}

function addItem(item, tipo='outro'){
  if(tipo === 'proteina'){
    const tam = document.getElementById('tamanho').value; // P ou G
    const max = (tam === 'P') ? 2 : 3;
    const qtdProteinas = quentinhaAtual.filter(isProteina).length;
    const jaTem = quentinhaAtual.includes(item);
    if(!jaTem && qtdProteinas >= max){
      alert(`Quentinha ${tam} s√≥ pode ter ${max} prote√≠nas.`);
      return;
    }
  }
  quentinhaAtual.push(item);
  renderSelecionados();
}

function limparQuentinhaAtual(){
  quentinhaAtual = [];
  renderSelecionados();
}

/* ======= Comanda ======= */
function adicionarQuentinha(){
  if(quentinhaAtual.length === 0){
    alert('Adicione itens √† quentinha antes.');
    return;
  }
  const tam = document.getElementById('tamanho').value;
  // Seguran√ßa extra: refor√ßa o limite no momento de adicionar
  const max = (tam === 'P') ? 2 : 3;
  const qtdProteinas = quentinhaAtual.filter(isProteina).length;
  if(qtdProteinas > max){
    alert(`Para tamanho ${tam}, no m√°ximo ${max} prote√≠nas.`);
    return;
  }
  pedido.push({ tamanho: tam, itens: [...quentinhaAtual] });
  quentinhaAtual = [];
  renderSelecionados();
  renderPedido();
  toast('‚úÖ Quentinha adicionada √† comanda!');
}

function renderPedido(){
  const tbody = document.querySelector('#pedidoTabela tbody');
  tbody.innerHTML = '';
  pedido.forEach((q, idx)=>{
    const itensTxt = q.itens.join(', ');
    tbody.innerHTML += `
      <tr>
        <td><strong>${q.tamanho}</strong></td>
        <td>${itensTxt}</td>
        <td style="text-align:center">
          <button class="btn-secondary" onclick="removerQuentinha(${idx})">Remover</button>
        </td>
      </tr>`;
  });
}

function removerQuentinha(index){
  pedido.splice(index,1);
  renderPedido();
}

/* ======= Impress√£o ======= */
function imprimirPedido(){
  if(pedido.length === 0){
    alert('Adicione ao menos uma quentinha na comanda.');
    return;
  }
  const cliente = (document.getElementById('cliente').value || 'N√£o informado').trim();
  const pagamento = document.getElementById('pagamento').value;
  const trocoParaStr = (document.getElementById('trocoPara').value || '').trim().replace(',', '.');
  const trocoPara = parseFloat(trocoParaStr) || 0;
  const statusPago = document.getElementById('statusPago').value;
  const tipoEntrega = document.getElementById('tipoEntrega').value; // retirada | entrega
  const bairro = document.getElementById('bairro').value;
  const obs = (document.getElementById('observacoes').value || '').trim();
  const dataHora = new Date().toLocaleString('pt-BR');

  // Calcula total das quentinhas
  let total = 0;
  let blocosQuentinhas = '';
  pedido.forEach((q, i)=>{
    const preco = (q.tamanho === 'P') ? PRECO_P : PRECO_G;
    total += preco;
    // lista itens em coluna
    const itensHTML = q.itens.map(x=>`‚Ä¢ ${x}`).join('<br>');
    blocosQuentinhas += `
      <div style="margin:8px 0 14px">
        <strong>Quentinha ${i+1} (${q.tamanho}) ‚Äî ${fmt(preco)}</strong><br>
        ${itensHTML}
      </div>`;
  });

  // Taxa de entrega
  let entregaHTML = '';
  if(tipoEntrega === 'entrega' && bairro){
    const taxa = taxasEntrega[bairro] ?? 0;
    total += taxa;
    entregaHTML = `<p><strong>Entrega:</strong> ${bairro} ‚Äî ${fmt(taxa)}</p>`;
  }
  // Pagamento e troco
  let pagamentoHTML = `<p><strong>Pagamento:</strong> ${pagamento.toUpperCase()}</p>`;
  let trocoCalcHTML = '';
  if(pagamento === 'dinheiro' && trocoPara > 0){
    pagamentoHTML += `<p><strong>Troco para:</strong> ${fmt(trocoPara)}</p>`;
    const troco = trocoPara - total;
    if(troco >= 0){
      trocoCalcHTML = `<p><strong>Troco:</strong> ${fmt(troco)}</p>`;
    }else{
      // Valor pago menor que o total ‚Äî informa diferen√ßa
      trocoCalcHTML = `<p><strong>Falta receber:</strong> ${fmt(Math.abs(troco))}</p>`;
    }
  }

  const statusHTML = `<p><strong>Status:</strong> ${statusPago === 'sim' ? 'Pago' : 'N√£o Pago'}</p>`;

  // Monta documento (sem mostrar o "dia" do card√°pio!)
  const conteudo = `
    <div style="font-family:Segoe UI, Arial, sans-serif; padding:10px 14px; line-height:1.35">
      <h2 style="color:#FF6600; margin:0 0 8px">Pedido ‚Äî ${cliente}</h2>
      <p style="margin:4px 0"><strong>Data/Hora:</strong> ${dataHora}</p>
      ${pagamentoHTML}
      ${statusHTML}
      ${entregaHTML}
      <hr style="border:none; border-top:1px solid #ccc; margin:12px 0">
      ${blocosQuentinhas}
      ${obs ? `<p style="margin:8px 0"><strong>Observa√ß√µes:</strong> ${obs}</p>` : ''}
      <hr style="border:none; border-top:1px solid #ccc; margin:12px 0">
      <p style="font-size:1.1em; margin:8px 0"><strong>Total:</strong> ${fmt(total)}</p>
      ${trocoCalcHTML}
    </div>
  `;

  const win = window.open('', '', 'width=720,height=760');
  win.document.write(`
    <html><head><title>Impress√£o</title>
      <meta charset="UTF-8">
      <style>
        body{ font-family:Segoe UI, Arial, sans-serif; }
        @media print{ body{ -webkit-print-color-adjust:exact; print-color-adjust:exact; } }
      </style>
    </head><body>${conteudo}</body></html>
  `);
  win.document.close();
  win.print();

  // Limpa comanda
  pedido = [];
  quentinhaAtual = [];
  renderPedido();
  renderSelecionados();
  document.getElementById('cliente').value = '';
  document.getElementById('observacoes').value = '';
}

/* ======= Inicializa√ß√£o ======= */
toggleEndereco();
toggleTroco();
atualizarMenu();
</script>
</body>
</html>
